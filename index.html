<!DOCTYPE html>
<html>
<head>
  <title>Deal Finder Upload Test</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <h2>Upload Property + Comps Files</h2>
  <form id="uploadForm" enctype="multipart/form-data" method="POST">
    <input type="text" name="businessName" placeholder="Business Name" required><br>
    <input type="text" name="userName" placeholder="Your Name" required><br>
    <input type="email" name="userEmail" placeholder="Your Email" required><br>
    <input type="file" name="propertyFile" required><br>
    <input type="file" name="compsFile" required><br>
    <button type="submit">Upload</button>
  </form>

  <p id="responseMsg" style="color:red;"></p>

  <script>
    $('#uploadForm').submit(function (e) {
      e.preventDefault();
      const formData = new FormData(this);

      $.ajax({
        url: '/upload',
        type: 'POST',
        data: formData,
        contentType: false,
        processData: false,
        success: function (res) {
          if (res.success) {
            $('#responseMsg').css('color', 'green').text('✅ Upload complete!');
          } else {
            $('#responseMsg').css('color', 'red').text('❌ Upload failed: ' + (res.message || 'Unknown error'));
            console.error("Upload error:", res);
          }
        },
        error: function (xhr, status, err) {
          $('#responseMsg').css('color', 'red').text('❌ Upload failed: ' + err);
          console.error("AJAX error:", xhr.responseText);
        }
      });
    });
  </script>
</body>
</html>